$lang: English
---------- Reviewed by: codex @ 2025-10-09 21:04:52

projects/ai2json/_ai2json/.REVIEW.md
    ├── claude.py
    └── codex.py

# Overview:
Claude2JSON and Codex2JSON adapters appear feature-complete and aligned with the shared template architecture: they locate platform-appropriate CLI entry points, enforce nuanced permission toggles, and normalize streamed JSON back into the higher-level extractor. Current revisions look cohesive and production-ready, with no functional regressions reported. Remaining attention centers on polish—particularly documentation and surfacing clearer diagnostics—rather than core behavior. Overall project maturity is high, though sustainability would benefit from targeted cleanup across docstrings, prompt-boundary clarity, and executable validation to guard against subtle operational surprises in multienvironment deployments.

# Review:
Both adapters deliver consistent discovery fallbacks (node script, bundled CLI, command) and aggressive JSON normalization, giving strong parity and testability across modules; completion is effectively 100% with no new regressions reported in individual reviews. Test hooks exist via deterministic entry probing and parsing, but explicit automated coverage is not documented. Primary risks cluster around maintainability: the project-wide absence of module/class docstrings slows onboarding, permission flags like `--dangerously-skip-permissions`/`--dangerously-bypass-approvals-and-sandbox` demand operational guardrails, and executable checks currently trust presence without validating executability or corruption, which complicates debugging. Secondary polish items include Claude’s aging permission commentary, Codex prompt concatenation that merges system/user context, and WSL edge cases in UID detection. Priorities should target documenting adapter contracts, tightening failure messaging around discovery/probing, and decoupling prompt handling semantics while preserving the proven runtime flow.

# Notes:
- Adapters mirror shared fallback launch strategy, aiding cross-platform resilience.
- Permission flag asymmetry (uid 0 vs non-root) is deliberate for Claude CLI stability.
- Claude and Codex streams delegate final JSON scrubbing to the hardened base extractor.

# Issues:
- Lack of module and class docstrings across adapters hurts maintainability and contradicts prior guidance.
- Executable discovery only checks for path existence, so corrupted or non-executable binaries fail late with opaque subprocess errors.

# Imperfections:
- Claude adapter’s verbose permission comments may drift from actual CLI semantics over time.
- Shared `_dump()` string interpolation typo persists and should be normalized when the base is next touched.
- Codex adapter concatenates system/user prompts in a single newline string, risking semantic ambiguity.
- `hasattr(os,'getuid')` root detection can misbehave on WSL/Cygwin but remains low risk currently.
