$lang: English
---------- Reviewed by: codex @ 2025-10-09 21:17:00

projects/ai2json/.REVIEW.md
    ├── ai2json.py
    ├── index.py
    └──── _ai2json/.REVIEW.md

# Overview:
The ai2json tooling appears mature: the shared runner now preserves recovered fenced payloads, adapters keep cross-platform CLI parity, and the abstract index contract remains stable. Recent work tightened fallback behavior without expanding scope, so the core extractor plus adapters look feature-complete and operationally ready. Documentation and diagnostics lag behind code quality, especially across adapters, which could challenge onboarding and troubleshooting. Permission overridings and executable probing are tuned for multi-environment CLI launches but still rely on implied conventions rather than explicit validation. Overall health is strong with small, well-scoped risks clustered around maintainability and guardrails rather than core functionality or regressions.

# Review:
Code quality is cohesive: ai2json.py defensively extracts JSON from AI CLIs with prompt-aware timeouts, and index.py cleanly defines the abstract orchestration layer. Submodule adapters mirror the shared launch strategy, giving consistent fallbacks and strong behavioral parity. Completion is effectively near 100%, and no regressions were surfaced in the reviewed snippets. However, documentation debt is notable—module/class docstrings are broadly missing, contradicting past guidance and hampering long-term sustainability. Operational robustness is solid but lacks hard executable validation, leaving room for confusing failures when binaries exist but are broken. Testability is passable via deterministic fallbacks, but explicit automated coverage is undocumented. Priorities should focus on documenting adapter contracts, surfacing clearer diagnostics around CLI discovery failures, validating executability earlier, and polishing permission prompts and prompt-composition semantics.

# Notes:
- Fallback JSON parsing fix in ai2json.py ensures adapters benefit from recovered fenced payloads.
- Adapters share a consistent discovery fallback chain (node script, bundled CLI, explicit command) aiding parity across environments.
- Permission-related CLI flags (`--dangerously-*`) require coordinated operational guardrails despite working defaults.

# Issues:
- Adapters lack module/class docstrings, creating a maintainability gap despite previous guidance.
- Executable discovery only checks for path existence, so corrupted or non-executable binaries fail later with opaque subprocess errors.

# Imperfections:
- Claude adapter permission comments may diverge from current CLI semantics over time.
- Shared `_dump()` string interpolation typo lingers in the adapter layer.
- Codex adapter merges system and user prompts into a single newline-delimited string, which could blur semantic boundaries.
- `hasattr(os,'getuid')` root detection can misbehave on WSL/Cygwin though impact is currently low.
